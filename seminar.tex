\documentclass[11pt]{article}
\usepackage{MyTemplate}
\begin{document}
\input{title}

\settextfont[Scale=1]{XB Yas}
\setlatintextfont[Scale=0.95]{Times New Roman}
%\settextfont{B Nazanin}
%\settextfont{XB Yas}
%\settextfont{XB Kayhan}

{\bf {چکيده: }}
دسته‌بندی تصاویر ریزدانه‌ای عبارت است از دسته‌بندی تصاویر در حالتی که دسته‌های مورد نظر همگی زیر دسته‌ی یک دسته‌ی کلی‌تر هستند. برای مثال برای زیر دسته‌ی کلی پرندگان ما می‌توانیم گونه‌های مختلف پرندگان را در نظر بگیریم. در این حالت خاص مسئله دسته‌ها معمولاً از نظر ظاهری بسیار به یکدیگر شبیه هستند به گونه‌ای که افراد غیر متخصص نمی‌توانند دسته‌ها را از یکدیگر تمایز دهند. در چنین شرایطی راه حل‌های ارائه شده برای مسئله دسته‌بندی تصاویر معمولی اکثراً نتایج خوبی کسب نمی‌کنند. لذا ارائه روش‌هایی جدید برای حل این مسئله لازم است.
در این گزارش ابتدا به مرور روش‌های مهم در دسته‌بندی تصاویر معمولی و سپس به مرور روش‌های ارائه شده برای دسته‌بندی تصاویر ریزدانه‌ای می‌پردازیم. سپس روش انتخاب شده و دلایل انتخاب آن را بررسی می‌کنیم.
% تعریف مختصر راه حل
% در این گزارش چه مواردی بیان خواهد شد و چه نتیجه‌ای گرفته خواهد شد.


{\bf  { واژه‌های کلیدی: }}
بینایی کامپیوتری، بازشناسی شیء، دسته‌بندی تصاویر، بازشناسی ریزدانه‌ای، دسته‌بندی تصاویر ریزدانه‌ای.

\setlength{\parindent}{0.25in} %The indent of the paragraph first line

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{مقدمه}\label{sec:intro}
% تعریف مسئله
در دسته‌بندی تصویر 
\footnote{\lr{Image classification}}
هر تصویر با توجه به محتوایش دسته‌بندی می‌شود. برای مثال آیا تصویر شامل شی‌ء خودرو هست یا خیر. معمولاً در بینایی کامپیوتری مسئله بدین صورت است که تعدادی دسته مشخص را در نظر می‌گیریم (مثلاً انسان، خودرو، ساختمان، تلویزیون، صندلی، اسب و ...) سپس طبق چارچوب معمول یادگیری ماشین، توسط تعدادی تصویر شامل یکی از دسته‌ها (نمونه‌های مثبت) و تعدادی تصویر بدون شی‌ای از آن دسته (نمونه‌های منفی) یادگیری برای آن دسته انجام می‌شود. در نهایت پس از یادگیری تمام دسته‌ها در مواجهه با تصویر جدید لازم است تشخیص دهیم که آیا شی‌ای از هر کدام از آن دسته‌های مورد بررسی در تصویر وجود دارد یا خیر.
برای نمونه به شکل
\ref{fig:intro:img_class_data}
توجه کنید. در این شکل داده‌های آموزشی و آزمایشی برای دسته‌بند دسته‌ی «صفحه کلید
\footnote{\lr{Computer - Keyboard}}
» از پایگاه داده
\lr{Caltech256} \cite{caltech256}
 نشان داده شده است.

\begin{figure}[b!]
	\centering
	\begin{subfigure}[h]{0.5\textwidth}
		\includegraphics[width=\textwidth]{keyboard_positive}
		\caption{نمونه‌های مثبت، شامل شی‌ء صفحه کلید}
		\label{fig:intro:img_class_data:train_pos}
	\end{subfigure}
	\begin{subfigure}[h]{0.5\textwidth}
		\includegraphics[width=\textwidth]{keyboard_negative}
		\caption{نمونه‌های منفی، بدون شی‌ء صفحه کلید}
		\label{fig:intro:img_class_data:train_neg}
	\end{subfigure}
	\begin{subfigure}[h]{0.5\textwidth}
		\centering
		\includegraphics[width=0.5\textwidth]{keyboard_q}
		\caption{تصویر جدید آزمایش}
		\label{fig:intro:img_class_data:query}
	\end{subfigure}
 
	\caption{نمونه‌ای از تصاویر آموزشی و آزمایشی سامانه دسته‌بند تصاویر برای دسته‌ی «صفحه کلید». انتخاب شده از پایگاه داده
\lr{Caltech256} \cite{caltech256}.
			سامانه لازم است با مشاهده نمونه‌های مثبت \ref{fig:intro:img_class_data:train_pos} و نمونه‌های منفی \ref{fig:intro:img_class_data:train_neg} یادگیری را انجام داده و بتواند پاسخ دهد که در تصویر جدید آزمایشی \ref{fig:intro:img_class_data:query} آیا صفحه کلید وجود دارد یا خیر. برای این نمونه پاسخ مثبت است.
			}
	\label{fig:intro:img_class_data}
\end{figure}
چالش‌های اصلی این مسئله تنوع زیاد اشیاء درون هر کدام از دسته‌ها، نحوه‌ی عکس برداری و وجود اشیاء دیگر در تصویر است که باعث ایجاد تصاویری با تنوع بالا می‌شود. مدل کردن این تنوع مربوط به اشیاء هر دسته باید همزمان با توانایی تمایز بین دسته‌های مختلف باشد. برای نمونه شکل
\ref{fig:intro:img_class_discrim}
تصویری از دو دسته مختلف مربوط به پایگاه داده
Imagenet \cite{imagenet}
را نمایش می‌دهد. مدل دسته‌بند باید توانایی تمایز بین این دو دسته شبیه به هم را داشته باشد.

\begin{figure}[t]
	\centering
	\begin{subfigure}[h]{0.35\textwidth}
		\centering
		\includegraphics[height=4 cm]{fighter}
		\caption{هواپیمای جنگنده}
	\end{subfigure}
	\begin{subfigure}[h]{0.35\textwidth}
		\centering
		\includegraphics[height=4 cm]{airliner}
		\caption{هواپیمای مسافربری}
	\end{subfigure}
	\caption{نمونه‌ای از دو دسته‌ی متفاوت ولی شبیه به هم از پایگاه داده
Imagenet \cite{imagenet}.
مدل دسته‌بند علاوه بر توانایی مدل‌سازی تفاوت‌های داخل دسته‌ای، باید توانایی تمایز بین دسته‌های گاها شبیه به یکدیگر را داشته باشد.
}
	\label{fig:intro:img_class_discrim}
\end{figure}

اگر در دسته‌بندی تصویر، دسته‌های مورد بررسی زیر دسته‌ی
\footnote{\lr{Subclass}}
یک دسته‌ی کلی‌تر باشند(مانند گونه‌های مختلف پرندگان، مدل‌های مختلف خودروهای سواری و انواع مختلف هواپیماها)، آنگاه مسئله را «دسته‌بندی ریزدانه‌ای تصویر
\footnote{\lr{Fine-grained image classification}}»
می‌نامند. در دسته‌بندی ریزدانه‌ای تصویر معمولاً شباهت دسته‌ها به یکدیگر بسیار زیاد است به نحوی که افراد غیر متخصص نمی‌توانند به راحتی این دسته‌ها را بازشناسی نمایند. برای نمونه در شکل
\ref{fig:intro:terns}
چند گونه‌ی مختلف از پرستوی دریایی
\footnote{\lr{Tern}}
متعلق به پایگاه داده
\lr{CUB-200-2011} \cite{cub2002011}
نمایش داده شده است. همانگونه که می‌بینید با اینکه این نمونه‌ها به نحوی انتخاب شده‌اند که وضعیت مشابهی دارند، هنوز هم پیدا کردن ویژگی‌های تمایز دهنده بین گونه‌های مختلف کار بسیار سختی است و نیاز به تخصص دارد.

\begin{figure}[h]
	\centering
	\begin{subfigure}[h]{0.23\textwidth}
		\includegraphics[height=2.5 cm]{Caspian_Tern}
		\caption{\lr{The Caspian tern}}
		\label{fig:intro:terns:1}
	\end{subfigure} 
	\begin{subfigure}[h]{0.23\textwidth}
		\includegraphics[height=2.5 cm]{Artic_Tern}
		\caption{\lr{The Artic tern}}
		\label{fig:intro:terns:2}
	\end{subfigure}
	\begin{subfigure}[h]{0.23\textwidth}
		\includegraphics[height=2.5 cm]{Common_Tern}
		\caption{\lr{The common tern}}
		\label{fig:intro:terns:3}
	\end{subfigure}
	\begin{subfigure}[h]{0.23\textwidth}
		\includegraphics[height=2.5 cm]{Elegant_Tern}
		\caption{\lr{The elegent tern}}
		\label{fig:intro:terns:4}
	\end{subfigure}
	\caption{چهار گونه‌ی مختلف از پرستوهای دریایی متعلق به پایگاه داده
\lr{CUB-200-2011} \cite{cub2002011}.
شباهت بسیار زیاد بین دسته‌های مختلف کار را حتی برای افراد غیر متخصص بسیار سخت می‌کند.
}
	\label{fig:intro:terns}
\end{figure}

روش‌های دسته‌بندی تصویر معمولی در مسايل دسته‌بندی ریزدانه‌ای اکثراً موفق نیستند (به بخش فولان مراجعه شود). دلیل اصلی این عدم موفقیت وجود ویژگی‌های بسیار اندک و شدیداً محلی تمایزدهنده
\footnote{\lr{Discriminative}}
برای دسته‌های ریزدانه ایست. برای مثال دو گونه‌ی
\lr{elegent tern} در شکل \ref{fig:intro:terns:4}
و
\lr{common tern} در شکل \ref{fig:intro:terns:3}
فقط در رنگ پا و شکل تاج با یکدیگر تفاوت دارند و در سایر اجزا غیر قابل تمایز هستند. 

% کاربردها
مسئله دسته‌بندی تصویر را می‌توان به دلیل کاربردهای زیاد آن یکی از اساسی‌ترین مسائل بینایی کامپیوتری دانست که امروزه مورد علاقه محققین در سطح جهان است. نتایج بهترین روش‌های دسته‌بندی تصاویر بر روی بزرگ‌ترین پایگاه داده‌های دسته‌بندی تصویر نشان داده است که اکثر خطای این روش‌ها مربوط به دسته‌هایی است که از نظر ظاهری به یکدیگر بسیار نزدیک هستند. به عبارت دیگر خطای این روش‌ها اکثراً خطای ریزدانه ایست (به بخش فولان مراجعه شود). لذا برای تقویت روش‌های دسته‌بندی تصویر، تمرکز بر روی دسته‌بندی ریزدانه‌ای اهمیت زیادی دارد.
از جمله کاربردهای مسئله دسته‌بندی ریزدانه‌ای تصویر می‌توان به موتورهای جستجو و بازیابی محتوا محور تصاویر
\footnote{\lr{Content based image retrieval}}
(برای مثال پیدا کردن مدل خاصی از یک خودرو در بین انبوهی از تصاویر)، سامانه‌های کمک آموزشی (آموزش گونه‌های مختلف حیوانات) و سامانه‌های نظارتی
\footnote{\lr{Surveillance systems}}
(کنترل ترافیک و تشخیص مدل‌های مختلف خودرو) اشاره کرد.

%آنچه خواهید خواند
در ادامه ابتدا در بخش
\ref{sec:img_class}
به معرفی سامانه‌های دسته‌بند تصویر معمولی و کارهای پیشین در این زمینه خواهیم پرداخت. سپس در بخش
\ref{sec:fg_class}
به معرفی روش‌های دسته‌بندی تصاویر ریزدانه‌ای و پایگاه داده‌های مرتبط با آن خواهیم پرداخت. در بخش فولان چند آزمایش و ایده برای ادامه کار را مطرح خواهیم کرد و نتایج ابتدایی را گزارش می‌دهیم. در انتها در بخش فولان نتیجه‌گیری‌ها و جمع‌بندی را مطرح می‌کنیم.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{دسته‌بندی تصاویر معمولی}\label{sec:img_class}
در این گزارش دسته‌بندی غیر ریزدانه‌ای تصاویر را معمولی خطاب می‌کنیم. همانطور که در مقدمه (بخش
\ref{sec:intro})
بیان شد، در دسته‌بندی تصویر، باید تصویر را با توجه به محتوایش دسته‌بندی کنیم. برای این منظور دسته‌ها را می‌توان به چندین صورت تعریف کرد. دسته‌های به صورت سنتی به دو دسته تقسیم می‌شدند: دسته‌بندی شیء
\footnote{\lr{Object classification}}
(برای مثال
\lr{Caltech101/256} \cite{caltech101, caltech256}
و
\lr{PASCAL VOC} \cite{pascalvoc})
و دسته‌بندی صحنه
\footnote{\lr{Scene classification}}
(برای مثال
\lr{MIT 67 Scene} \cite{mit67scene}).
در دسته‌بندی شیء لازم است که وجود و یا عدم وجود شی‌ای از دسته‌های مورد نظر در تصویر را تشخیص دهیم و لازم نیست که مکان آن شی‌ء را در تصویر مشخص نماییم. در دسته‌بندی صحنه لازم است از بین صحنه‌های مورد بررسی تشخیص دهیم که تصویر متعلق به کدام صحنه است. برای مثال تصویر
\ref{fig:img_class:object_vs_scene}
را در نظر بگیرید. فرض کنید که شی‌ء‌های هواپیما، اتوبوس، خودرو سواری و اسب را در مد نظر داریم و می‌خواهیم دسته‌بندی شی‌ء را برای تصویر
\ref{fig:img_class:object_vs_scene}
انجام دهیم. در این حالت خروجی سامانه باید بدین صورت باشد: «هواپیما در تصویر وجود دارد. اوتوبوس در تصویر وجود دارد. خودرو سواری و اسب در تصویر وجود ندارد». حالا اگر صحنه‌های فرودگاه، فروشگاه و مسجد را در نظر بگیریم و بخواهیم دسته‌بندی صحنه را برای تصویر انجام دهیم، خروجی سامانه باید بدین صورت باشد: «تصویر صحنه فرودگاه را نشان می‌دهد».
\begin{figure}[t!]
	\centering
	\includegraphics[height=4 cm]{object_vs_scene}
	\caption{نمونه خروجی سامانه‌های دسته‌بندی شی‌ء و صحنه. برای دسته‌بندی شی‌ء اگر شی‌ءهای هواپیما، اتوبوس، خودرو سواری و اسب را مد نظر داشته باشیم، خروجی سامانه باید بدین صورت باشد: «هواپیما در تصویر وجود دارد. اوتوبوس در تصویر وجود دارد. خودرو سواری و اسب در تصویر وجود ندارد».
برای دسته‌بندی صحنه اگر صحنه‌های فرودگاه، فروشگاه و مسجد را در نظر بگیریم، خروجی سامانه باید بدین صورت باشد: «تصویر صحنه فرودگاه را نشان می‌دهد».}
	\label{fig:img_class:object_vs_scene}
\end{figure}

در سال‌های اخیر محققین به دسته‌بندی‌های دیگری نیز روی آورده‌اند. برای نمونه می‌توان به بازشناسی صفت
\footnote{\lr{Attribute recognition}}\cite{farhadi2009}
و بازشناسی افعال
\footnote{\lr{Action recognition}}
در تصاویر
\cite{bangpeng2011}
اشاره کرد.
در این گزارش تمرکز بر دسته‌بندی شی‌ء خواهد بود. در ادامه برخی روش‌های دسته‌بندی شیء در تصاویر را بررسی خواهیم کرد.

\subsection{روش‌های مبتنی بر لغت‌نامه}\label{sec:img_class:vocab_based}
روش‌های مبتنی بر لغت‌نامه از قدیمی‌ترین روش‌ها در دسته‌بندی تصویر هستند که هنوز هم مورد استفاده قرار می‌گیرند. ایده اولیه این روش‌ها از تحقیقات پردازش متن گرفته شده است. در پردازش متن، یک لغت‌نامه داریم و یک متن  و می‌خواهیم متن را دسته‌بندی کنیم. اگر فرکانس لغات داخل متن را محاسبه کنیم، می‌بینیم که لغات پر تکرار در متون ورزشی مشترک هستند. این مشاهده باعث شد که روش‌های مبتنی بر لغت‌نامه برای دسته‌بندی متن مورد استفاده قرار بگیرند.

محققان بررسی کردند که همین مشاهدات در مورد تصاویر نیز برقرار است. برای مثال فرض کنیم که لغات را در تصاویر به صورت تکه‌ای از تصویر تعریف کنیم. حال اگر لغت معادل دهان، چشم و بینی را در تصویری مشاهده کنیم می‌توانیم نتیجه بگیریم که به احتمال زیاد تصویر مربوط به یک چهره است. البته مسئله برای تصویر از متن پیچیده‌تر است، زیرا لغت‌نامه‌ای در دسترس نیست و همچنین پیدا کردن لغت‌ها کار مشکلی است.

کلیت این روش‌ها بر پایه‌ی دسته‌بندی در یادگیری ماشین است. بدین صورت که تعدادی تصویر آموزشی و دسته‌های آن‌ها (برچسب) را در اختیار داریم. ابتدا یک مدل دسته‌بند مثل
\lr{SVM} \cite{svm}
را انتخاب می‌کنیم و با داده‌های آموزشی مدل را آموزش می‌دهیم. حال برای داده‌های آزمایشی با استفاده از مدل برجسب را تخمین می‌زنیم. برای استفاده از این چارچوب دسته‌بندی باید نمایش برداری مناسبی از تصاویر داشته باشیم که در آموزش و آزمایش طول یکسانی داشته باشد. در ادامه به راه حل‌های مختلف برای ساخت این نمایش برداری می‌پردازیم.
\subsubsection{روش کیسه‌ای از لغات}
روش «کیسه‌ای از لغات»
\footnote{\lr{Bag of keypoints}}
از قدیمی‌ترین روش‌های پیدا کردن نمایش برداری برای مسئله دسته‌بندی است
\cite{csurka2004}.
در این روش کیسه‌ای از لغات به هیستوگرام تعداد تکرارهای الگوهای خاصی در تصویر گفته می‌شود. این الگوهای خاص همان لغات لغت‌نامه هستند. در شکل
\ref{fig:img_class:bow_vocab}
روش ساخت لغت‌نامه با پیدا کردن و توصیف نقاط کلیدی نشان داده شده است.
\begin{figure}[t!]
	\centering
	\includegraphics[height= 7 cm]{bow_vocab}
	\caption{روش ساخت لغت‌نامه در روش کیسه‌ای از لغات}
	\label{fig:img_class:bow_vocab}
\end{figure}
گام‌های این روش برای ساخت لغت‌نامه بدین صورت است:
\begin{itemize}
	\item در مجموعه تصاویر آموزشی نقاط کلیدی
	\footnote{\lr{Keypoints}}
	را توسط الگوریتمی مثل
	\lr{Harris-Affine} \cite{harris_affine}
	یا به صورت چگال
	\footnote{Dense}
	تشخیص می‌دهیم.

	\item نقاط کلیدی را توسط توصیفگری مثل
	\lr{SIFT} \cite{sift}
	توصیف می‌کنیم.
	\item با اعمال یکی از روش‌های تدریج برداری
	\footnote{\lr{Vector quantization}}
	مثل
	\lr{KMeans}
	توصیفگر هر قطعه از تصاویر را به یکی از مراکز خوشه‌های
	\footnote{\lr{Clusters}}
	لغت‌نامه اختصاص می‌دهیم.
\end{itemize}
بدین ترتیب روش مناسبی برای ساخت لغت‌نامه داریم. پس از ساخت لغت‌نامه در هنگام آموزش و یا آزمایش نقاط کلیدی پیدا شده در تصویر را به نزدیک‌ترین لغت در لغت‌نامه به توصیفشان نگاشت می‌شود. حال نمایش نهایی هر تصویر برابر هیستوگرام تعداد تکرارهای هر کدام از لغات در تصویر است که طول ثابتی برابر با طول لغت‌نامه دارد.
%محاسن و معایب روش
\subsubsection{روش \lr{Spatial Pyramid Matching}}
\subsubsection{روش \lr{Sparse Coding}}
\subsubsection{روش \lr{Fisher Kernel}}

\subsection{روش‌های مبتنی بر یادگیری عمیق}
%تحلیل ویژگی‌ها و مدل‌ها
\subsection{نتیجه‌گیری}
%کدام روش کودینگ بهتر است؟ شیطان در جزئیات است.
%ماتریس ابهام و ساختار آن و لازمه‌ی مطالعه روش‌های ریزدانه‌ای
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{دسته‌بندی ریزدانه‌ای تصویر}\label{sec:fg_class}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\linespread{1}
\small
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}

\renewcommand{\bibname}{مراجع}
\begin{latin}
\bibliographystyle{IEEEtran}
%\bibliography{IEEEfull,ref}
\bibliography{IEEEabrv,ref}
\end{latin}



\section*{واژه‌نامه}
%\begin{LTR}
\begin{multicols}{3}
\theendnotes 
\end{multicols}
%\end{LTR}
\end{document}
